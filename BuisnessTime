Function IsWorkday(dDate As Date, Holidays() As Variant) As Boolean

If WorksheetFunction.WorkDay(dDate - 1, 1, Holidays()) = dDate Then
    IsWorkday = True
Else
    IsWorkday = False
End If

End Function



Function BuisnessHours(dDate As Date, hours As Integer, tStart As Date, tEnd As Date, Holidays() As Variant) As Date

'We check if day of arrival of request is during working day.
Do Until IsWorkday(dDate, Holidays())
    dDate = WorksheetFunction.RoundDown(dDate, 0) + tStart + 1 'we start at start time next day
Loop

'We check if time of arrival of request is within working hours! If hour is within <tStart,tEnd> we do not change anything.
If TimeSerial(Hour(dDate), Minute(dDate), 0) > tEnd Then
    dDate = WorksheetFunction.RoundUp(dDate, 0) + tStart
ElseIf TimeSerial(Hour(dDate), Minute(dDate), 0) < tStart Then
    dDate = WorksheetFunction.RoundDown(dDate, 0) + tStart
End If


End Function
